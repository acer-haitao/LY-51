C51 COMPILER V7.06   _ìÍâ½âÂë1602Ò____ÔÊ_                                                  06/15/2010 11:29:25 PAGE 1   


C51 COMPILER V7.06, COMPILATION OF MODULE _ìÍâ½âÂë1602Ò____ÔÊ_
OBJECT MODULE PLACED IN .\obj\ºìÍâ½âÂë1602Òº¾§ÏÔÊ¾.obj
COMPILER INVOKED BY: d:\Keil\C51\BIN\C51.EXE ºìÍâ½âÂë1602Òº¾§ÏÔÊ¾.c BROWSE DEBUG OBJECTEXTEND PRINT(.\obj\ºìÍâ½âÂë1602Òº
                    -¾§ÏÔÊ¾.lst) OBJECT(.\obj\ºìÍâ½âÂë1602Òº¾§ÏÔÊ¾.obj)

stmt level    source

   1          /*-----------------------------------------------
   2            Ãû³Æ£ºÒ£¿ØÆ÷ºìÍâ½âÂëÊýÒº¾§ÏÔÊ¾
   3            ÂÛÌ³£ºwww.doflye.net
   4            ±àÐ´£ºshifang
   5            ÈÕÆÚ£º2009.5
   6            ÐÞ¸Ä£ºÎÞ
   7            ÄÚÈÝ£º°´ÅäÌ×Ò£¿ØÆ÷°´¼ü£¬Òº¾§ÏÔÊ¾4×éÂëÖµ£¬·Ö±ðÊÇÓÃ»§Âë ÓÃ»§Âë Êý¾ÝÂë Êý¾Ý·´Âë
   8                  ÏÔÊ¾ÈçÏÂ£º
   9                           www.doflye.net
  10                           Code:1E-1E-00-FF
  11          ------------------------------------------------*/
  12          #include<reg52.h>    //°üº¬Í·ÎÄ¼þ£¬Ò»°ãÇé¿ö²»ÐèÒª¸Ä¶¯£¬Í·ÎÄ¼þ°üº¬ÌØÊâ¹¦ÄÜ¼Ä´æÆ÷µÄ¶¨Òå
  13          #include"1602.h"
  14          #include"delay.h"
  15          
  16          sbit IR=P3^2;  //ºìÍâ½Ó¿Ú±êÖ¾
  17          
  18          char code Tab[16]="0123456789ABCDEF";
  19          /*------------------------------------------------
  20                          È«¾Ö±äÁ¿ÉùÃ÷
  21          ------------------------------------------------*/
  22          
  23          unsigned char  irtime;//ºìÍâÓÃÈ«¾Ö±äÁ¿
  24          
  25          bit irpro_ok,irok;
  26          unsigned char IRcord[4];
  27          unsigned char irdata[33];
  28          
  29          unsigned char TempData[16];
  30          /*------------------------------------------------
  31                            º¯ÊýÉùÃ÷
  32          ------------------------------------------------*/
  33          void Ir_work(void);
  34          void Ircordpro(void);
  35          
  36          /*------------------------------------------------
  37                            ¶¨Ê±Æ÷0ÖÐ¶Ï´¦Àí
  38          ------------------------------------------------*/
  39          
  40          void tim0_isr (void) interrupt 1 using 1
  41          {
  42   1        irtime++;  //ÓÃÓÚ¼ÆÊý2¸öÏÂ½µÑØÖ®¼äµÄÊ±¼ä
  43   1      }
  44          
  45          /*------------------------------------------------
  46                            Íâ²¿ÖÐ¶Ï0ÖÐ¶Ï´¦Àí
  47          ------------------------------------------------*/
  48          void EX0_ISR (void) interrupt 0 //Íâ²¿ÖÐ¶Ï0·þÎñº¯Êý
  49          {
  50   1        static unsigned char  i;             //½ÓÊÕºìÍâÐÅºÅ´¦Àí
  51   1        static bit startflag;                //ÊÇ·ñ¿ªÊ¼´¦Àí±êÖ¾Î»
  52   1      
  53   1      if(startflag)                         
  54   1         {
C51 COMPILER V7.06   _ìÍâ½âÂë1602Ò____ÔÊ_                                                  06/15/2010 11:29:25 PAGE 2   

  55   2          if(irtime<63&&irtime>=33)//Òýµ¼Âë TC9012µÄÍ·Âë£¬9ms+4.5ms
  56   2                              i=0;
  57   2                      irdata[i]=irtime;//´æ´¢Ã¿¸öµçÆ½µÄ³ÖÐøÊ±¼ä£¬ÓÃÓÚÒÔºóÅÐ¶ÏÊÇ0»¹ÊÇ1
  58   2                      irtime=0;
  59   2                      i++;
  60   2                               if(i==33)
  61   2                              {
  62   3                                       irok=1;
  63   3                                       i=0;
  64   3                                      }
  65   2                }
  66   1               else
  67   1                      {
  68   2                      irtime=0;
  69   2                      startflag=1;
  70   2                      }
  71   1      
  72   1      }
  73          
  74          /*------------------------------------------------
  75                          ¶¨Ê±Æ÷0³õÊ¼»¯
  76          ------------------------------------------------*/
  77          void TIM0init(void)//¶¨Ê±Æ÷0³õÊ¼»¯
  78          {
  79   1      
  80   1        TMOD=0x02;//¶¨Ê±Æ÷0¹¤×÷·½Ê½2£¬TH0ÊÇÖØ×°Öµ£¬TL0ÊÇ³õÖµ
  81   1        TH0=0x00; //ÖØÔØÖµ
  82   1        TL0=0x00; //³õÊ¼»¯Öµ
  83   1        ET0=1;    //¿ªÖÐ¶Ï
  84   1        TR0=1;    
  85   1      }
  86          /*------------------------------------------------
  87                            Íâ²¿ÖÐ¶Ï0³õÊ¼»¯
  88          ------------------------------------------------*/
  89          void EX0init(void)
  90          {
  91   1       IT0 = 1;   //Ö¸¶¨Íâ²¿ÖÐ¶Ï0ÏÂ½µÑØ´¥·¢£¬INT0 (P3.2)
  92   1       EX0 = 1;   //Ê¹ÄÜÍâ²¿ÖÐ¶Ï
  93   1       EA = 1;    //¿ª×ÜÖÐ¶Ï
  94   1      }
  95          /*------------------------------------------------
  96                            ¼üÖµ´¦Àí
  97          ------------------------------------------------*/
  98          
  99          void Ir_work(void)
 100          {
 101   1             TempData[0] = Tab[IRcord[0]/16];   //´¦Àí¿Í»§Âë
 102   1                 TempData[1] = Tab[IRcord[0]%16];
 103   1             TempData[2] = '-';
 104   1                 TempData[3] = Tab[IRcord[1]/16];   //´¦Àí¿Í»§Âë
 105   1                 TempData[4] = Tab[IRcord[1]%16];
 106   1                 TempData[5] = '-';
 107   1                 TempData[6] = Tab[IRcord[2]/16];   //´¦ÀíÊý¾ÝÂë
 108   1                 TempData[7] = Tab[IRcord[2]%16];
 109   1                 TempData[8] = '-';
 110   1                 TempData[9] = Tab[IRcord[3]/16];   //´¦ÀíÊý¾Ý·´Âë
 111   1                 TempData[10] = Tab[IRcord[3]%16];
 112   1      
 113   1             LCD_Write_String(5,1,TempData);
 114   1      
 115   1                 irpro_ok=0;//´¦ÀíÍê³É±êÖ¾
 116   1      
C51 COMPILER V7.06   _ìÍâ½âÂë1602Ò____ÔÊ_                                                  06/15/2010 11:29:25 PAGE 3   

 117   1        }
 118          /*------------------------------------------------
 119                          ºìÍâÂëÖµ´¦Àí
 120          ------------------------------------------------*/
 121          void Ircordpro(void)//ºìÍâÂëÖµ´¦Àíº¯Êý
 122          { 
 123   1        unsigned char i, j, k;
 124   1        unsigned char cord,value;
 125   1      
 126   1        k=1;
 127   1        for(i=0;i<4;i++)      //´¦Àí4¸ö×Ö½Ú
 128   1           {
 129   2            for(j=1;j<=8;j++) //´¦Àí1¸ö×Ö½Ú8Î»
 130   2               {
 131   3                cord=irdata[k];
 132   3                if(cord>7)//´óÓÚÄ³ÖµÎª1£¬Õâ¸öºÍ¾§ÕñÓÐ¾ø¶Ô¹ØÏµ£¬ÕâÀïÊ¹ÓÃ12M¼ÆËã£¬´ËÖµ¿ÉÒÔÓÐÒ»¶¨Îó²î
 133   3                   value|=0x80;
 134   3                if(j<8)
 135   3                          {
 136   4                               value>>=1;
 137   4                              }
 138   3                 k++;
 139   3               }
 140   2           IRcord[i]=value;
 141   2           value=0;     
 142   2           } 
 143   1               irpro_ok=1;//´¦ÀíÍê±Ï±êÖ¾Î»ÖÃ1
 144   1      }
 145          
 146          /*------------------------------------------------
 147                              Ö÷º¯Êý
 148          ------------------------------------------------*/
 149          void main(void)
 150          {
 151   1       EX0init();            //³õÊ¼»¯Íâ²¿ÖÐ¶Ï
 152   1       TIM0init();           //³õÊ¼»¯¶¨Ê±Æ÷
 153   1      
 154   1       LCD_Init();           //³õÊ¼»¯Òº¾§
 155   1       DelayMs(20);          //ÑÓÊ±ÓÐÖúÓÚÎÈ¶¨
 156   1       LCD_Clear();          //ÇåÆÁ
 157   1      
 158   1       LCD_Write_String(0,0,"www.doflye.net");
 159   1       LCD_Write_String(0,1,"Code:");
 160   1      
 161   1       while(1)//Ö÷Ñ­»·
 162   1         {
 163   2          if(irok)                        //Èç¹û½ÓÊÕºÃÁË½øÐÐºìÍâ´¦Àí
 164   2                {   
 165   3                 Ircordpro();
 166   3                 irok=0;
 167   3                }
 168   2      
 169   2          if(irpro_ok)                   //Èç¹û´¦ÀíºÃºó½øÐÐ¹¤×÷´¦Àí£¬Èç°´¶ÔÓ¦µÄ°´¼üºóÏÔÊ¾¶ÔÓ¦µÄÊý×ÖµÈ
 170   2                {
 171   3                 Ir_work();
 172   3                }
 173   2         }
 174   1      }
 175            
 176            


C51 COMPILER V7.06   _ìÍâ½âÂë1602Ò____ÔÊ_                                                  06/15/2010 11:29:25 PAGE 4   

MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    283    ----
   CONSTANT SIZE    =     37    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =     55    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =      3    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
